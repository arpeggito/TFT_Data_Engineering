version: 2

Ow:

models:
  - name: operations_personnel_costs
    description: 'Report on full time employee payroll costs per market and department'

    tests:
      - unique:
          column_name: "concat(market, date_month)"

    columns:
      - name: date_month
        description: 'The FTE cost month. The resulting cost if for the employees work for this specific month.'
        tests:
          - not_null

      - name: market
        description: 'Tourlane official market where the cost is attributed'
        tests:
          - not_null
          - accepted_values:
              values: [
                'tourlane.de',
                'tourlane.fr',
                'tourlane.com',
                'tourlane.co.uk',
                'tourlane.nl',
                'hq',
                'xx']

      - name: presales_fte_cost
        description: 'Cost of Presales team full time employees'
        tests:
          - not_null

      - name: sales_fte_cost
        description: 'Cost of Sales team full time employees'
        tests:
          - not_null:
              where: "not(date_month < '2019-11-01' and market = 'tourlane.com')"

      - name: customer_service_fte_cost
        description: 'Cost of Customer Services team full time employees'
        tests:
          - not_null:
              where: "date_month >= '2020-01-01'"
